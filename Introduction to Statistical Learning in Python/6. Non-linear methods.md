---
aliases: 
checked: false
created: 2024-06-09
last_edited: 2024-06-09
publish: false
tags: 
type: lecture
---
# Non-linear methods

Transformation of the input space.
- [[Polynomial regression|polynomial regression]]:  Use polynomial features,
- Step functions: Cut region up and take mean,
- Regression splines: Cut region up and fit polynomials with smooth intersections,
	- What is the difference between this and [[Boosting]]?
- Smoothing splines: Similar to regression,
- Local regression: Similar to splines but with overlapping boundaries,
- [[Generalised Additive Models (GAM)]]: Combining all the above,

## Polynomial regression

![[Polynomial regression]]

Here we will focus on $k=1$.

This has issues with error explosion outside a certain region.

## Step functions

![[Step function methods]]

One of the simplest methods in [[Step function methods|step function methods]] is to choose meaningful intervals in your [[Function domain|domain]]. Then setting $\hat{f}(x)$ to be the mean of [[Testing data|test data]] in this region. This is likely not applied much we are using this as an idea to be used with other methods.

To apply this we use a one hot embedding.

We should only use this if there are natural breakpoints where we can input domain knowledge.

## Piece-wise polynomials

Here instead of using constant values we switch this to a polynomial.

## Basis function

These form a basis of your functional space.

## Regression splines

A degree D spline is a piecewise polynomial with degree $D$ with continuity in derivatives up to degree $D-1$.

### Cublic spline

A cubic spline is given by
$$
f(x) = \beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3 + \sum_{k=1}^K \beta_{k+3} (x - \zeta_k)^3_+
$$
where $\zeta_k$ denotes the cut points for $k = 1, \ldots, K$ and
$$
(x - \zeta_k)^3_+ = \begin{cases} (x- \zeta_k)^3 & \mbox{ if } x > \zeta_k\\ 0 & \mbox{otherwise} \end{cases}
$$
This donates a basis of the cubic splines.

This generalises to power $D$ splines being of the same form.

### Degrees of freedom

There will be 4 + K degrees of freedom where $K$ is the number of breakpoints.

In comparison piecewise polynomial regression with $K$ breakpoints we have $(D+1)(K+1)$ degrees of freedom.

### Natural cubic spline

A natural cubic spline has linear components before and after the first and last spline.

### Choosing knots

- Place more knots where your function varies more rapidly.
- Place knots in uniform way, e.g. quantity of data.
- Use cross validation.

## Smoothing splines

First choose a loss function:
$$
RSS = \sum_{i=1}^n (y_i - g(x_i)^2)
$$
If $g$ can be anything then we can find error 0 but would massively over fit. We could try minimizing $RSS$ subject to $g$ being smooth.

Smooth splines by minimising the following loss function
$$
RSS + \lambda \int g''(t)^2 dt.
$$





